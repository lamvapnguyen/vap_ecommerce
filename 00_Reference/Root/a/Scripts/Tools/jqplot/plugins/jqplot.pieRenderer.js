(function(n){function u(t,i,r){var u,f;if(r=r||{},r.axesDefaults=r.axesDefaults||{},r.legend=r.legend||{},r.seriesDefaults=r.seriesDefaults||{},u=!1,r.seriesDefaults.renderer==n.jqplot.PieRenderer)u=!0;else if(r.series)for(f=0;f<r.series.length;f++)r.series[f].renderer==n.jqplot.PieRenderer&&(u=!0);u&&(r.axesDefaults.renderer=n.jqplot.PieAxisRenderer,r.legend.renderer=n.jqplot.PieLegendRenderer,r.legend.preDraw=!0)}function f(){for(i=0;i<this.series.length;i++)this.series[i].renderer.constructor==n.jqplot.PieRenderer&&this.series[i].highlightMouseOver&&(this.series[i].highlightMouseDown=!1);this.target.bind("mouseout",{plot:this},function(n){t(n.data.plot)})}function e(){for(var n=0;n<this.series.length;n++)this.series[n].seriesColors=this.seriesColors,this.series[n].colorGenerator=this.colorGenerator}function r(n,t,i){var r=n.series[t],u=n.plugins.pieRenderer.highlightCanvas;u._ctx.clearRect(0,0,u._ctx.canvas.width,u._ctx.canvas.height);r._highlightedPoint=i;n.plugins.pieRenderer.highlightedSeriesIndex=t;r.renderer.drawSlice.call(r,u._ctx,r._sliceAngles[i][0],r._sliceAngles[i][1],r.highlightColorGenerator.get(i),!1)}function t(n){var i=n.plugins.pieRenderer.highlightCanvas,t;for(i._ctx.clearRect(0,0,i._ctx.canvas.width,i._ctx.canvas.height),t=0;t<n.series.length;t++)n.series[t]._highlightedPoint=null;n.plugins.pieRenderer.highlightedSeriesIndex=null;n.target.trigger("jqplotDataUnhighlight")}function o(n,i,u,f,e){var o,s,h;f?(o=[f.seriesIndex,f.pointIndex,f.data],s=jQuery.Event("jqplotDataMouseOver"),s.pageX=n.pageX,s.pageY=n.pageY,e.target.trigger(s,o),!e.series[o[0]].highlightMouseOver||o[0]==e.plugins.pieRenderer.highlightedSeriesIndex&&o[1]==e.series[o[0]]._highlightedPoint||(h=jQuery.Event("jqplotDataHighlight"),h.pageX=n.pageX,h.pageY=n.pageY,e.target.trigger(h,o),r(e,o[0],o[1]))):f==null&&t(e)}function s(n,i,u,f,e){var o,s;f?(o=[f.seriesIndex,f.pointIndex,f.data],!e.series[o[0]].highlightMouseDown||o[0]==e.plugins.pieRenderer.highlightedSeriesIndex&&o[1]==e.series[o[0]]._highlightedPoint||(s=jQuery.Event("jqplotDataHighlight"),s.pageX=n.pageX,s.pageY=n.pageY,e.target.trigger(s,o),r(e,o[0],o[1]))):f==null&&t(e)}function h(n,i,r,u,f){var e=f.plugins.pieRenderer.highlightedSeriesIndex;e!=null&&f.series[e].highlightMouseDown&&t(f)}function c(n,t,i,r,u){if(r){var e=[r.seriesIndex,r.pointIndex,r.data],f=jQuery.Event("jqplotDataClick");f.pageX=n.pageX;f.pageY=n.pageY;u.target.trigger(f,e)}}function l(n,i,r,u,f){var s,o,e;u&&(s=[u.seriesIndex,u.pointIndex,u.data],o=f.plugins.pieRenderer.highlightedSeriesIndex,o!=null&&f.series[o].highlightMouseDown&&t(f),e=jQuery.Event("jqplotDataRightClick"),e.pageX=n.pageX,e.pageY=n.pageY,f.target.trigger(e,s))}function a(){var t,i;this.plugins.pieRenderer={highlightedSeriesIndex:null};this.plugins.pieRenderer.highlightCanvas=new n.jqplot.GenericCanvas;t=n(this.targetId+" .jqplot-data-label");t.length?n(t[0]).before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions)):this.eventCanvas._elem.before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions));i=this.plugins.pieRenderer.highlightCanvas.setContext()}n.jqplot.PieRenderer=function(){n.jqplot.LineRenderer.call(this)};n.jqplot.PieRenderer.prototype=new n.jqplot.LineRenderer;n.jqplot.PieRenderer.prototype.constructor=n.jqplot.PieRenderer;n.jqplot.PieRenderer.prototype.init=function(t,i){var v,u;if(this.diameter=null,this.padding=20,this.sliceMargin=0,this.fill=!0,this.shadowOffset=2,this.shadowAlpha=.07,this.shadowDepth=5,this.highlightMouseOver=!0,this.highlightMouseDown=!1,this.highlightColors=[],this.dataLabels="percent",this.showDataLabels=!1,this.dataLabelFormatString=null,this.dataLabelThreshold=3,this.dataLabelPositionFactor=.52,this.dataLabelNudge=2,this.dataLabelCenterOn=!0,this.startAngle=0,this.tickRenderer=n.jqplot.PieTickRenderer,t.highlightMouseDown&&t.highlightMouseOver==null&&(t.highlightMouseOver=!1),n.extend(!0,this,t),this.diameter!=null&&(this.diameter=this.diameter-this.sliceMargin),this._diameter=null,this._radius=null,this._sliceAngles=[],this._highlightedPoint=null,this.highlightColors.length==0)for(v=0;v<this.seriesColors.length;v++){var y=n.jqplot.getColorComponents(this.seriesColors[v]),r=[y[0],y[1],y[2]],p=r[0]+r[1]+r[2];for(u=0;u<3;u++)r[u]=p>570?r[u]*.8:r[u]+.3*(255-r[u]),r[u]=parseInt(r[u],10);this.highlightColors.push("rgb("+r[0]+","+r[1]+","+r[2]+")")}this.highlightColorGenerator=new n.jqplot.ColorGenerator(this.highlightColors);i.postParseOptionsHooks.addOnce(e);i.postInitHooks.addOnce(f);i.eventListenerHooks.addOnce("jqplotMouseMove",o);i.eventListenerHooks.addOnce("jqplotMouseDown",s);i.eventListenerHooks.addOnce("jqplotMouseUp",h);i.eventListenerHooks.addOnce("jqplotClick",c);i.eventListenerHooks.addOnce("jqplotRightClick",l);i.postDrawHooks.addOnce(a)};n.jqplot.PieRenderer.prototype.setGridData=function(){for(var u,t=[],i=[],f=this.startAngle/180*Math.PI,r=0,n=0;n<this.data.length;n++)t.push(this.data[n][1]),i.push([this.data[n][0]]),n>0&&(t[n]+=t[n-1]),r+=this.data[n][1];for(u=Math.PI*2/t[t.length-1],n=0;n<t.length;n++)i[n][1]=t[n]*u,i[n][2]=this.data[n][1]/r;this.gridData=i};n.jqplot.PieRenderer.prototype.makeGridData=function(n){for(var f,i=[],r=[],u=0,e=this.startAngle/180*Math.PI,t=0;t<n.length;t++)i.push(n[t][1]),r.push([n[t][0]]),t>0&&(i[t]+=i[t-1]),u+=n[t][1];for(f=Math.PI*2/i[i.length-1],t=0;t<i.length;t++)r[t][1]=i[t]*f,r[t][2]=n[t][1]/u;return r};n.jqplot.PieRenderer.prototype.drawSlice=function(n,t,i,r,u){function e(){(i>6.282+this.startAngle&&(i=6.282+this.startAngle,t>i&&(t=6.281+this.startAngle)),t!=i)&&(n.beginPath(),n.fillStyle=r,n.strokeStyle=r,n.lineWidth=h,n.arc(0,0,o,t,i,!1),n.lineTo(0,0),n.closePath(),s?n.fill():n.stroke())}var o=this._diameter/2,s=this.fill,h=this.lineWidth,f;if(n.save(),n.translate(this._center[0],this._center[1]),n.translate(this.sliceMargin*Math.cos((t+i)/2),this.sliceMargin*Math.sin((t+i)/2)),u)for(f=0;f<this.shadowDepth;f++)n.save(),n.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI)),e();else e();if(u)for(f=0;f<this.shadowDepth;f++)n.restore();n.restore()};n.jqplot.PieRenderer.prototype.draw=function(t,i,r,u){var a=r!=undefined?r:{},o=0,v=0,s=1,rt=new n.jqplot.ColorGenerator(this.seriesColors),f,st,l,tt,e,h,k,c,d,y;if(r.legendInfo&&r.legendInfo.placement=="insideGrid"){f=r.legendInfo;switch(f.location){case"nw":o=f.width+f.xoffset;break;case"w":o=f.width+f.xoffset;break;case"sw":o=f.width+f.xoffset;break;case"ne":o=f.width+f.xoffset;s=-1;break;case"e":o=f.width+f.xoffset;s=-1;break;case"se":o=f.width+f.xoffset;s=-1;break;case"n":v=f.height+f.yoffset;break;case"s":v=f.height+f.yoffset;s=-1}}var ht=a.shadow!=undefined?a.shadow:this.shadow,ct=a.showLine!=undefined?a.showLine:this.showLine,lt=a.fill!=undefined?a.fill:this.fill,g=t.canvas.width,nt=t.canvas.height,ut=g-o-2*this.padding,ft=nt-v-2*this.padding,et=Math.min(ut,ft),ot=et;if(this._diameter=this.diameter||ot-this.sliceMargin,st=this._radius=this._diameter/2,l=this.startAngle/180*Math.PI,this._center=[(g-s*o)/2+s*o,(nt-s*v)/2+s*v],this.shadow)for(tt="rgba(0,0,0,"+this.shadowAlpha+")",e=0;e<i.length;e++)h=e==0?l:i[e-1][1]+l,h+=this.sliceMargin/180*Math.PI,this.renderer.drawSlice.call(this,t,h,i[e][1]+l,tt,!0);for(e=0;e<i.length;e++)if(h=e==0?l:i[e-1][1]+l,h+=this.sliceMargin/180*Math.PI,k=i[e][1]+l,this._sliceAngles.push([h,k]),this.renderer.drawSlice.call(this,t,h,k,rt.next(),!1),this.showDataLabels&&i[e][2]*100>=this.dataLabelThreshold){d=(h+k)/2;this.dataLabels=="label"?(c=this.dataLabelFormatString||"%s",y=n.jqplot.sprintf(c,i[e][0])):this.dataLabels=="value"?(c=this.dataLabelFormatString||"%d",y=n.jqplot.sprintf(c,i[e][1])):this.dataLabels=="percent"?(c=this.dataLabelFormatString||"%d%%",y=n.jqplot.sprintf(c,i[e][2]*100)):this.dataLabels.constructor==Array&&(c=this.dataLabelFormatString||"%s",y=n.jqplot.sprintf(c,this.dataLabels[e]));var it=this._radius*this.dataLabelPositionFactor+this.sliceMargin+this.dataLabelNudge,p=this._center[0]+Math.cos(d)*it+this.canvas._offsets.left,w=this._center[1]+Math.sin(d)*it+this.canvas._offsets.top,b=n('<div class="jqplot-pie-series jqplot-data-label" style="position:absolute;">'+y+"<\/div>").insertBefore(u.eventCanvas._elem);this.dataLabelCenterOn?(p-=b.width()/2,w-=b.height()/2):(p-=b.width()*Math.sin(d/2),w-=b.height()/2);p=Math.round(p);w=Math.round(w);b.css({left:p,top:w})}};n.jqplot.PieAxisRenderer=function(){n.jqplot.LinearAxisRenderer.call(this)};n.jqplot.PieAxisRenderer.prototype=new n.jqplot.LinearAxisRenderer;n.jqplot.PieAxisRenderer.prototype.constructor=n.jqplot.PieAxisRenderer;n.jqplot.PieAxisRenderer.prototype.init=function(t){this.tickRenderer=n.jqplot.PieTickRenderer;n.extend(!0,this,t);this._dataBounds={min:0,max:100};this.min=0;this.max=100;this.showTicks=!1;this.ticks=[];this.showMark=!1;this.show=!1};n.jqplot.PieLegendRenderer=function(){n.jqplot.TableLegendRenderer.call(this)};n.jqplot.PieLegendRenderer.prototype=new n.jqplot.TableLegendRenderer;n.jqplot.PieLegendRenderer.prototype.constructor=n.jqplot.PieLegendRenderer;n.jqplot.PieLegendRenderer.prototype.init=function(t){this.numberRows=null;this.numberColumns=null;n.extend(!0,this,t)};n.jqplot.PieLegendRenderer.prototype.draw=function(){var d=this,w,t,r,u,a,f,v,e,y,p,b,o;if(this.show){w=this._series;t="position:absolute;";t+=this.background?"background:"+this.background+";":"";t+=this.border?"border:"+this.border+";":"";t+=this.fontSize?"font-size:"+this.fontSize+";":"";t+=this.fontFamily?"font-family:"+this.fontFamily+";":"";t+=this.textColor?"color:"+this.textColor+";":"";t+=this.marginTop!=null?"margin-top:"+this.marginTop+";":"";t+=this.marginBottom!=null?"margin-bottom:"+this.marginBottom+";":"";t+=this.marginLeft!=null?"margin-left:"+this.marginLeft+";":"";t+=this.marginRight!=null?"margin-right:"+this.marginRight+";":"";this._elem=n('<table class="jqplot-table-legend" style="'+t+'"><\/table>');var h=!1,c=!1,i,s,l=w[0],k=new n.jqplot.ColorGenerator(l.seriesColors);if(l.show)for(r=l.data,this.numberRows?(i=this.numberRows,s=this.numberColumns?this.numberColumns:Math.ceil(r.length/i)):this.numberColumns?(s=this.numberColumns,i=Math.ceil(r.length/this.numberColumns)):(i=r.length,s=1),o=0,u=0;u<i;u++)for(f=c?n('<tr class="jqplot-table-legend"><\/tr>').prependTo(this._elem):n('<tr class="jqplot-table-legend"><\/tr>').appendTo(this._elem),a=0;a<s;a++)o<r.length&&(y=this.labels[o]||r[o][0].toString(),b=k.next(),h=c?u==i-1?!1:!0:u>0?!0:!1,p=h?this.rowSpacing:"0",v=n('<td class="jqplot-table-legend" style="text-align:center;padding-top:'+p+';"><div><div class="jqplot-table-legend-swatch" style="border-color:'+b+';"><\/div><\/div><\/td>'),e=n('<td class="jqplot-table-legend" style="padding-top:'+p+';"><\/td>'),this.escapeHtml?e.text(y):e.html(y),c?(e.prependTo(f),v.prependTo(f)):(v.appendTo(f),e.appendTo(f)),h=!0),o++}return this._elem};n.jqplot.PieRenderer.prototype.handleMove=function(n,i,u,f,e){if(f){var o=[f.seriesIndex,f.pointIndex,f.data];e.target.trigger("jqplotDataMouseOver",o);!e.series[o[0]].highlightMouseOver||o[0]==e.plugins.pieRenderer.highlightedSeriesIndex&&o[1]==e.series[o[0]]._highlightedPoint||(e.target.trigger("jqplotDataHighlight",o),r(e,o[0],o[1]))}else f==null&&t(e)};n.jqplot.preInitHooks.push(u);n.jqplot.PieTickRenderer=function(){n.jqplot.AxisTickRenderer.call(this)};n.jqplot.PieTickRenderer.prototype=new n.jqplot.AxisTickRenderer;n.jqplot.PieTickRenderer.prototype.constructor=n.jqplot.PieTickRenderer})(jQuery);