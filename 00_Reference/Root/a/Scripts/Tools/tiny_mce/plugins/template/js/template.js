tinyMCEPopup.requireLangPack();var TemplateDialog={preInit:function(){var n=tinyMCEPopup.getParam("template_external_list_url");n!=null&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(n)+'"><\/script>')},init:function(){var r=tinyMCEPopup.editor,t,i,n;if(t=r.getParam("template_templates",!1),i=document.getElementById("tpath"),!t&&typeof tinyMCETemplateList!="undefined")for(n=0,t=[];n<tinyMCETemplateList.length;n++)t.push({title:tinyMCETemplateList[n][0],src:tinyMCETemplateList[n][1],description:tinyMCETemplateList[n][2]});for(n=0;n<t.length;n++)i.options[i.options.length]=new Option(t[n].title,tinyMCEPopup.editor.documentBaseURI.toAbsolute(t[n].src));this.resize();this.tsrc=t},resize:function(){var t,i,n;self.innerWidth?(t=self.innerWidth-50,i=self.innerHeight-170):(t=document.body.clientWidth-50,i=document.body.clientHeight-160);n=document.getElementById("templatesrc");n&&(n.style.height=Math.abs(i)+"px",n.style.width=Math.abs(t-5)+"px")},loadCSSFiles:function(n){var t=tinyMCEPopup.editor;tinymce.each(t.getParam("content_css","").split(","),function(i){n.write('<link href="'+t.documentBaseURI.toAbsolute(i)+'" rel="stylesheet" type="text/css" />')})},selectTemplate:function(n,t){var u=window.frames.templatesrc.document,i,r=this.tsrc;if(n)for(u.body.innerHTML=this.templateHTML=this.getFileContents(n),i=0;i<r.length;i++)r[i].title==t&&(document.getElementById("tmpldesc").innerHTML=r[i].description||"")},insert:function(){tinyMCEPopup.execCommand("mceInsertTemplate",!1,{content:this.templateHTML,selection:tinyMCEPopup.editor.selection.getContent()});tinyMCEPopup.close()},getFileContents:function(n){function i(n){t=0;try{t=new ActiveXObject(n)}catch(n){}return t}var t;return t=window.ActiveXObject?i("Msxml2.XMLHTTP")||i("Microsoft.XMLHTTP"):new XMLHttpRequest,t.overrideMimeType&&t.overrideMimeType("text/plain"),t.open("GET",n,!1),t.send(null),t.responseText}};TemplateDialog.preInit();tinyMCEPopup.onInit.add(TemplateDialog.init,TemplateDialog);