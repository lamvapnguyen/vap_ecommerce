function init(){tinyMCEPopup.resizeToInnerSize();document.getElementById("backgroundimagebrowsercontainer").innerHTML=getBrowserHTML("backgroundimagebrowser","backgroundimage","image","table");document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor");var r=tinyMCEPopup.editor,t=r.dom,n=t.getParent(r.selection.getStart(),"tr"),i=document.forms[0],u=t.parseStyle(t.getAttrib(n,"style")),f=n.parentNode.nodeName.toLowerCase(),e=t.getAttrib(n,"align"),o=t.getAttrib(n,"valign"),s=trimSize(getStyle(n,"height","height")),h=t.getAttrib(n,"class"),c=convertRGBToHex(getStyle(n,"bgcolor","backgroundColor")),l=getStyle(n,"background","backgroundImage").replace(new RegExp("url\\(['\"]?([^'\"]*)['\"]?\\)","gi"),"$1"),a=t.getAttrib(n,"id"),v=t.getAttrib(n,"lang"),y=t.getAttrib(n,"dir");selectByValue(i,"rowtype",f);t.select("td.mceSelected,th.mceSelected",n).length==0?(addClassesToList("class","table_row_styles"),TinyMCE_EditableSelects.init(),i.bgcolor.value=c,i.backgroundimage.value=l,i.height.value=s,i.id.value=a,i.lang.value=v,i.style.value=t.serializeStyle(u),selectByValue(i,"align",e),selectByValue(i,"valign",o),selectByValue(i,"class",h,!0,!0),selectByValue(i,"dir",y),isVisible("backgroundimagebrowser")&&(document.getElementById("backgroundimage").style.width="180px"),updateColor("bgcolor_pick","bgcolor")):tinyMCEPopup.dom.hide("action")}function updateAction(){var t=tinyMCEPopup.editor,r=t.dom,f,u,o=document.forms[0],e=getSelectValue(o,"action"),i,n;if(tinyMCEPopup.restoreSelection(),f=r.getParent(t.selection.getStart(),"tr"),u=r.getParent(t.selection.getStart(),"table"),r.select("td.mceSelected,th.mceSelected",f).length>0){tinymce.each(u.rows,function(n){for(var t=0;t<n.cells.length;t++)if(r.hasClass(n.cells[t],"mceSelected")){updateRow(n,!0);return}});t.addVisual();t.nodeChanged();t.execCommand("mceEndUndoLevel");tinyMCEPopup.close();return}switch(e){case"row":updateRow(f);break;case"all":for(i=u.getElementsByTagName("tr"),n=0;n<i.length;n++)updateRow(i[n],!0);break;case"odd":case"even":for(i=u.getElementsByTagName("tr"),n=0;n<i.length;n++)(n%2==0&&e=="odd"||n%2!=0&&e=="even")&&updateRow(i[n],!0,!0)}t.addVisual();t.nodeChanged();t.execCommand("mceEndUndoLevel");tinyMCEPopup.close()}function updateRow(n,t,i){var s=tinyMCEPopup.editor,u=document.forms[0],r=s.dom,a=n.parentNode.nodeName.toLowerCase(),h=getSelectValue(u,"rowtype"),v=s.getDoc(),o;if(t||r.setAttrib(n,"id",u.id.value),r.setAttrib(n,"align",getSelectValue(u,"align")),r.setAttrib(n,"vAlign",getSelectValue(u,"valign")),r.setAttrib(n,"lang",u.lang.value),r.setAttrib(n,"dir",getSelectValue(u,"dir")),r.setAttrib(n,"style",r.serializeStyle(r.parseStyle(u.style.value))),r.setAttrib(n,"class",getSelectValue(u,"class")),r.setAttrib(n,"background",""),r.setAttrib(n,"bgColor",""),r.setAttrib(n,"height",""),n.style.height=getCSSSize(u.height.value),n.style.backgroundColor=u.bgcolor.value,n.style.backgroundImage=u.backgroundimage.value!=""?"url('"+u.backgroundimage.value+"')":"",a!=h&&!i){var c=n.cloneNode(1),f=r.getParent(n,"table"),l=h,e=null;for(o=0;o<f.childNodes.length;o++)f.childNodes[o].nodeName.toLowerCase()==l&&(e=f.childNodes[o]);e==null&&(e=v.createElement(l),f.firstChild.nodeName=="CAPTION"?s.dom.insertAfter(e,f.firstChild):f.insertBefore(e,f.firstChild));e.appendChild(c);n.parentNode.removeChild(n);n=c}r.setAttrib(n,"style",r.serializeStyle(r.parseStyle(n.style.cssText)))}function changedBackgroundImage(){var n=document.forms[0],t=tinyMCEPopup.editor.dom,i=t.parseStyle(n.style.value);i["background-image"]="url('"+n.backgroundimage.value+"')";n.style.value=t.serializeStyle(i)}function changedStyle(){var t=document.forms[0],i=tinyMCEPopup.editor.dom,n=i.parseStyle(t.style.value);t.backgroundimage.value=n["background-image"]?n["background-image"].replace(new RegExp("url\\('?([^']*)'?\\)","gi"),"$1"):"";n.height&&(t.height.value=trimSize(n.height));n["background-color"]&&(t.bgcolor.value=n["background-color"],updateColor("bgcolor_pick","bgcolor"))}function changedSize(){var n=document.forms[0],t=tinyMCEPopup.editor.dom,i=t.parseStyle(n.style.value),r=n.height.value;i.height=r!=""?getCSSSize(r):"";n.style.value=t.serializeStyle(i)}function changedColor(){var n=document.forms[0],t=tinyMCEPopup.editor.dom,i=t.parseStyle(n.style.value);i["background-color"]=n.bgcolor.value;n.style.value=t.serializeStyle(i)}tinyMCEPopup.requireLangPack();tinyMCEPopup.onInit.add(init);