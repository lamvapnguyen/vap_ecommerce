(function(){tinymce.create("tinymce.plugins.Save",{init:function(n){var t=this;t.editor=n;n.addCommand("mceSave",t._save,t);n.addCommand("mceCancel",t._cancel,t);n.addButton("save",{title:"save.save_desc",cmd:"mceSave"});n.addButton("cancel",{title:"save.cancel_desc",cmd:"mceCancel"});n.onNodeChange.add(t._nodeChange,t);n.addShortcut("ctrl+s",n.getLang("save.save_desc"),"mceSave")},getInfo:function(){return{longname:"Save",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/save",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_nodeChange:function(n,t){var n=this.editor;n.getParam("save_enablewhendirty")&&(t.setDisabled("save",!n.isDirty()),t.setDisabled("cancel",!n.isDirty()))},_save:function(){var n=this.editor,t,i;if(t=tinymce.DOM.get(n.id).form||tinymce.DOM.getParent(n.id,"form"),!n.getParam("save_enablewhendirty")||n.isDirty()){if(tinyMCE.triggerSave(),i=n.getParam("save_onsavecallback")){n.execCallback("save_onsavecallback",n)&&(n.startContent=tinymce.trim(n.getContent({format:"raw"})),n.nodeChanged());return}t?(n.isNotDirty=!0,(t.onsubmit==null||t.onsubmit()!=!1)&&t.submit(),n.nodeChanged()):n.windowManager.alert("Error: No form element found.")}},_cancel:function(){var n=this.editor,t,i=tinymce.trim(n.startContent);if(t=n.getParam("save_oncancelcallback")){n.execCallback("save_oncancelcallback",n);return}n.setContent(i);n.undoManager.clear();n.nodeChanged()}});tinymce.PluginManager.add("save",tinymce.plugins.Save)})();