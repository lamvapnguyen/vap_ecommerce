(function(){function n(n){return document.getElementById(n)}function i(t){var i=n(t);return i.nodeName=="SELECT"?i.options[i.selectedIndex].value:i.type=="checkbox"?i.checked:i.value}function t(t,i){if(typeof i!="undefined"){var r=n(t);r.nodeName=="SELECT"?selectByValue(document.forms[0],t,i):r.type=="checkbox"?r.checked=typeof i=="string"?i.toLowerCase()==="true"?!0:!1:!!i:r.value=i}}var r;(r=tinyMCEPopup.getParam("media_external_list_url"))&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(r)+'"><\/script>');window.Media={init:function(){var r,u,f,e,o;this.editor=u=tinyMCEPopup.editor;n("qtsrcfilebrowsercontainer").innerHTML=getBrowserHTML("qtsrcfilebrowser","quicktime_qtsrc","media","media");n("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor");n("video_altsource1_filebrowser").innerHTML=getBrowserHTML("filebrowser_altsource1","video_altsource1","media","media");n("video_altsource2_filebrowser").innerHTML=getBrowserHTML("filebrowser_altsource2","video_altsource2","media","media");n("video_poster_filebrowser").innerHTML=getBrowserHTML("filebrowser_poster","video_poster","media","image");f=document.forms[0];u.settings.isBroswer?n("srcbrowser_link").onclick=function(){window.parent.open_fmgr&&window.parent.open_fmgr(function(n){f.src.value=n;updatePreview()},"media",1)}:n("srcbrowser_link").style.display="none";r=this.getMediaListHTML("medialist","src","media","media");r==""?n("linklistrow").style.display="none":n("linklistcontainer").innerHTML=r;isVisible("filebrowser")&&(n("src").style.width="230px");isVisible("filebrowser_altsource1")&&(n("video_altsource1").style.width="220px");isVisible("filebrowser_altsource2")&&(n("video_altsource2").style.width="220px");isVisible("filebrowser_poster")&&(n("video_poster").style.width="220px");e=parseInt(i("width")||"320",10);o=parseInt(i("height")||"240",10);t("width",e);t("height",o);document.forms[0].insert.value=u.getLang("update","Insert",!0);this.data=tinyMCEPopup.getWindowArg("data");this.dataToForm();this.preview()},insert:function(){var n=tinyMCEPopup.editor;this.formToData();n.execCommand("mceRepaint");tinyMCEPopup.restoreSelection();n.selection.setNode(n.plugins.media.dataToImg(this.data));tinyMCEPopup.close()},preview:function(){n("prev").innerHTML=this.editor.plugins.media.dataToHtml(this.data,!0)},moveStates:function(r,u){function v(n){var t={};return n!=undefined&&n!=""&&tinymce.each(n.split("&"),function(n){var i=n.split("=");t[unescape(i[0])]=unescape(i[1])}),t}function o(n,u){var l,h,c,e,o;if(n==f.type||n=="global")for(u=tinymce.explode(u),l=0;l<u.length;l++)h=u[l],c=n=="global"?h:n+"_"+h,n=="global"?o=f:n=="video"?(o=f.video.attrs,o||r||(f.video.attrs=o={})):o=f.params,o&&(r?t(c,o[h]):(delete o[h],e=i(c),n=="video"&&e===!0&&(e=h),s[c]?e!==s[c]&&(e=""+e,o[h]=e):e&&(e=""+e,o[h]=e)))}var f=this.data,h=this.editor,f=this.data,a=h.plugins.media,c,l,s,e;s={quicktime_autoplay:!0,quicktime_controller:!0,flash_play:!0,flash_loop:!0,flash_menu:!0,windowsmedia_autostart:!0,windowsmedia_enablecontextmenu:!0,windowsmedia_invokeurls:!0,realmedia_autogotourl:!0,realmedia_imagestatus:!0};r||(f.type=n("media_type").options[n("media_type").selectedIndex].value,f.width=i("width"),f.height=i("height"),e=i("src"),u=="src"&&(c=e.replace(/^.*\.([^.]+)$/,"$1"),(l=a.getType(c))&&(f.type=l.name.toLowerCase()),t("media_type",f.type)),f.type=="video"&&(f.video.sources||(f.video.sources=[]),f.video.sources[0]={src:i("src")}));n("video_options").style.display="none";n("flash_options").style.display="none";n("quicktime_options").style.display="none";n("shockwave_options").style.display="none";n("windowsmedia_options").style.display="none";n("realmedia_options").style.display="none";n(f.type+"_options")&&(n(f.type+"_options").style.display="block");t("media_type",f.type);o("flash","play,loop,menu,swliveconnect,quality,scale,salign,wmode,base,flashvars");o("quicktime","loop,autoplay,cache,controller,correction,enablejavascript,kioskmode,autohref,playeveryframe,targetcache,scale,starttime,endtime,target,qtsrcchokespeed,volume,qtsrc");o("shockwave","sound,progress,autostart,swliveconnect,swvolume,swstretchstyle,swstretchhalign,swstretchvalign");o("windowsmedia","autostart,enabled,enablecontextmenu,fullscreen,invokeurls,mute,stretchtofit,windowlessvideo,balance,baseurl,captioningid,currentmarker,currentposition,defaultframe,playcount,rate,uimode,volume");o("realmedia","autostart,loop,autogotourl,center,imagestatus,maintainaspect,nojava,prefetch,shuffle,console,controls,numloop,scriptcallbacks");o("video","poster,autoplay,loop,preload,controls");o("global","id,name,vspace,hspace,bgcolor,align,width,height");r?f.type=="video"?(f.video.sources[0]&&t("src",f.video.sources[0].src),e=f.video.sources[1],e&&t("video_altsource1",e.src),e=f.video.sources[2],e&&t("video_altsource2",e.src)):(f.type=="flash"&&tinymce.each(h.getParam("flash_video_player_flashvars",{url:"$url",poster:"$poster"}),function(n,t){n=="$url"&&(f.params.src=v(f.params.flashvars)[t]||f.params.src)}),t("src",f.params.src)):(e=i("src"),e.match(/youtube.com(.+)v=([^&]+)/)&&(f.width=425,f.height=350,f.params.frameborder="0",f.type="iframe",e="http://www.youtube.com/embed/"+e.match(/v=([^&]+)/)[1],t("src",e),t("media_type",f.type)),e.match(/video.google.com(.+)docid=([^&]+)/)&&(f.width=425,f.height=326,f.type="flash",e="http://video.google.com/googleplayer.swf?docId="+e.match(/docid=([^&]+)/)[1]+"&hl=en",t("src",e),t("media_type",f.type)),f.type=="video"?(f.video.sources||(f.video.sources=[]),f.video.sources[0]={src:e},e=i("video_altsource1"),e&&(f.video.sources[1]={src:e}),e=i("video_altsource2"),e&&(f.video.sources[2]={src:e})):f.params.src=e,t("width",f.width||320),t("height",f.height||240))},dataToForm:function(){this.moveStates(!0)},formToData:function(n){(n=="width"||n=="height")&&this.changeSize(n);n=="source"?(this.moveStates(!1,n),t("source",this.editor.plugins.media.dataToHtml(this.data)),this.panel="source"):(this.panel=="source"&&(this.data=this.editor.plugins.media.htmlToData(i("source")),this.dataToForm(),this.panel=""),this.moveStates(!1,n),this.preview())},beforeResize:function(){this.width=parseInt(i("width")||"320",10);this.height=parseInt(i("height")||"240",10)},changeSize:function(r){var u,f;n("constrain").checked&&(u=parseInt(i("width")||"320",10),f=parseInt(i("height")||"240",10),r=="width"?(this.height=Math.round(u/this.width*f),t("height",this.height),t("width",u)):(this.width=Math.round(f/this.height*u),t("height",f),t("width",this.width)))},getMediaListHTML:function(){var n,t;if(typeof tinyMCEMediaList!="undefined"&&tinyMCEMediaList.length>0){for(n="",n+='<select id="linklist" name="linklist" style="width: 250px" onchange="this.form.src.value=this.options[this.selectedIndex].value;Media.formToData(\'src\');">',n+='<option value="">---<\/option>',t=0;t<tinyMCEMediaList.length;t++)n+='<option value="'+tinyMCEMediaList[t][1]+'">'+tinyMCEMediaList[t][0]+"<\/option>";return n+"<\/select>"}return""}};tinyMCEPopup.requireLangPack();tinyMCEPopup.onInit.add(function(){Media.init()})})();