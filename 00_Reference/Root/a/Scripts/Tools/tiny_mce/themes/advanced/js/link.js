tinyMCEPopup.requireLangPack();var LinkDialog={preInit:function(){var n;(n=tinyMCEPopup.getParam("external_link_list_url"))&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(n)+'"><\/script>')},browseResource:function(){},init:function(){var t=document.forms[0],n=tinyMCEPopup.editor;n.settings.isBroswer?document.getElementById("href").style.width="180px":document.getElementById("srcbrowser_link").style.display="none";this.fillClassList("class_list");this.fillFileList("link_list","tinyMCELinkList");this.fillTargetList("target_list");(e=n.dom.getParent(n.selection.getNode(),"A"))&&(t.href.value=n.dom.getAttrib(e,"href"),t.linktitle.value=n.dom.getAttrib(e,"title"),t.insert.value=n.getLang("update"),selectByValue(t,"link_list",t.href.value),selectByValue(t,"target_list",n.dom.getAttrib(e,"target")),selectByValue(t,"class_list",n.dom.getAttrib(e,"class")))},update:function(){var n=document.forms[0],t=tinyMCEPopup.editor,i,r;if(tinyMCEPopup.restoreSelection(),i=t.dom.getParent(t.selection.getNode(),"A"),!n.href.value&&i){tinyMCEPopup.execCommand("mceBeginUndoLevel");r=t.selection.getBookmark();t.dom.remove(i,1);t.selection.moveToBookmark(r);tinyMCEPopup.execCommand("mceEndUndoLevel");tinyMCEPopup.close();return}tinyMCEPopup.execCommand("mceBeginUndoLevel");i==null?(t.getDoc().execCommand("unlink",!1,null),tinyMCEPopup.execCommand("CreateLink",!1,"#mce_temp_url#",{skip_undo:1}),tinymce.each(t.dom.select("a"),function(r){t.dom.getAttrib(r,"href")=="#mce_temp_url#"&&(i=r,t.dom.setAttribs(i,{href:n.href.value,title:n.linktitle.value,target:n.target_list?n.target_list.options[n.target_list.selectedIndex].value:null,"class":n.class_list?n.class_list.options[n.class_list.selectedIndex].value:null}))})):t.dom.setAttribs(i,{href:n.href.value,title:n.linktitle.value,target:n.target_list?n.target_list.options[n.target_list.selectedIndex].value:null,"class":n.class_list?n.class_list.options[n.class_list.selectedIndex].value:null});tinyMCEPopup.execCommand("mceEndUndoLevel");tinyMCEPopup.close()},checkPrefix:function(n){n.value&&Validator.isEmail(n)&&!/^\s*mailto:/i.test(n.value)&&confirm(tinyMCEPopup.getLang("advanced_dlg.link_is_email"))&&(n.value="mailto:"+n.value);/^\s*www\./i.test(n.value)&&confirm(tinyMCEPopup.getLang("advanced_dlg.link_is_external"))&&(n.value="http://"+n.value)},fillFileList:function(n,t){var r=tinyMCEPopup.dom,i=r.get(n);t=window[t];t&&t.length>0?(i.options[i.options.length]=new Option("",""),tinymce.each(t,function(n){i.options[i.options.length]=new Option(n[0],n[1])})):r.remove(r.getParent(n,"tr"))},fillClassList:function(n){var r=tinyMCEPopup.dom,i=r.get(n),u,t;(u=tinyMCEPopup.getParam("theme_advanced_styles"))?(t=[],tinymce.each(u.split(";"),function(n){var i=n.split("=");t.push({title:i[0],"class":i[1]})})):t=tinyMCEPopup.editor.dom.getClasses();t.length>0?(i.options[i.options.length]=new Option(tinyMCEPopup.getLang("not_set"),""),tinymce.each(t,function(n){i.options[i.options.length]=new Option(n.title||n["class"],n["class"])})):r.remove(r.getParent(n,"tr"))},fillTargetList:function(n){var r=tinyMCEPopup.dom,t=r.get(n),i;t.options[t.options.length]=new Option(tinyMCEPopup.getLang("not_set"),"");t.options[t.options.length]=new Option(tinyMCEPopup.getLang("advanced_dlg.link_target_same"),"_self");t.options[t.options.length]=new Option(tinyMCEPopup.getLang("advanced_dlg.link_target_blank"),"_blank");(i=tinyMCEPopup.getParam("theme_advanced_link_targets"))&&tinymce.each(i.split(","),function(n){n=n.split("=");t.options[t.options.length]=new Option(n[0],n[1])})}};LinkDialog.preInit();tinyMCEPopup.onInit.add(LinkDialog.init,LinkDialog);