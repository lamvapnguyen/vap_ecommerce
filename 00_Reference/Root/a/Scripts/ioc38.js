var __ioc38={_hdf_value:"",_lbl_size:"",_lbl_color1:"",_lbl_color2:"",_lbl_color3:"",_lbl_color4:"",init:function(n){__ioc38._hdf_value=n;__init_fcurrency2($(".ioc36_price0"));__init_fcurrency2($(".ioc36_subtotal0"));$("#ucDMDataManager5_Edit1_ctl04_Order_ShipGateway_1_List, #ucDMDataManager5_Edit1_ctl04_Order_ShipQuanHuyen_1_List").change(function(){__ioc38.calcShipFee()});$("#ucDMDataManager5_Edit1_ctl01_OrderSubTotal_1_txt_Value, #ucDMDataManager5_Edit1_ctl01_Order_ShipFee_1_txt_Value, #ucDMDataManager5_Edit1_ctl01_Order_CouponValue_1_txt_Value").blur(function(){__ioc38.calcTotal()});$("#ucDMDataManager5_Edit1_ctl01_OrderSubTotal_1_txt_Value, #ucDMDataManager5_Edit1_ctl01_Order_Money_1_txt_Value").css("background","#f5f5f5");$("#ioc38_sel_cat").change(function(){var n=$(this).val();n>0&&($("#ioc38_sel_product").html('<option value="0">loading...<\/option>'),$.post(__gvars.ajurl,{action:"html_opt_product",catid:n},function(n){$("#ioc38_sel_product").html(n).change(function(){var n=$(this).val();n>0&&($("#ioc38_sel_size,#ioc38_sel_color1,#ioc38_sel_color2,#ioc38_sel_color3,#ioc38_sel_color4").html('<option value="0">loading...<\/option>'),$.post(__gvars.ajurl,{action:"product_prop",i:n},function(n){if(n!=""){var t=n.split("<|>");$("#ioc38sample").attr("c",t[0]);$("#ioc38sample").attr("n",t[1]);$("#ioc38sample").attr("p",t[2]);$("#ioc38_sel_quantity").val(1);$("#ioc38_sel_size").html(t[3]==""?'<option value="0">--- '+__ioc38._lbl_size+" ---<\/option>":t[3]);$("#ioc38_sel_color1").html(t[4]==""?'<option value="0">--- '+__ioc38._lbl_color1+" ---<\/option>":t[4]);$("#ioc38_sel_color2").html(t[5]==""?'<option value="0">--- '+__ioc38._lbl_color2+" ---<\/option>":t[5]);$("#ioc38_sel_color3").html(t[6]==""?'<option value="0">--- '+__ioc38._lbl_color3+" ---<\/option>":t[6]);$("#ioc38_sel_color4").html(t[7]==""?'<option value="0">--- '+__ioc38._lbl_color4+" ---<\/option>":t[7])}}))}).change()}))}).change()},add:function(){var t=$("#ioc38sample"),c=$("#ioc38_sel_product").val(),l=t.attr("c"),o=t.attr("n"),s=t.attr("p"),h=s==""?"0":t.attr("p").replace(/,/g,""),n=$("#ioc38_sel_quantity").val(),i=$("#ioc38_sel_size").val(),r=$("#ioc38_sel_color1").val(),u=$("#ioc38_sel_color2").val(),f=$("#ioc38_sel_color3").val(),e=$("#ioc38_sel_color4").val();if(s_size=i==0?"":$("#ioc38_sel_size").children("option[value="+i+"]").text(),s_color1=r==0?"":$("#ioc38_sel_color1").children("option[value="+r+"]").text(),s_color2=u==0?"":$("#ioc38_sel_color2").children("option[value="+u+"]").text(),s_color3=f==0?"":$("#ioc38_sel_color3").children("option[value="+f+"]").text(),s_color4=e==0?"":$("#ioc38_sel_color4").children("option[value="+e+"]").text(),n==""||n<=0){alert("Bạn chưa chọn Số lượng.");return}if(o==""||o==""){alert("Bạn chưa chọn Sản phẩm.");return}$("#ioc38_table_tbl").find("tr:first").parent().append('<tr class="item" i="'+c+'" p="'+h+'" q="'+n+'" s="'+i+'" c1="'+r+'" c2="'+u+'" c3="'+f+'" c4="'+e+'"><td align="center" class="ioc38i"><\/td><td align="center"><div class="ioc28code">'+l+'<\/div><\/td><td><div class="ioc28name">'+o+'<\/div><\/td><td align="center">'+n+'<\/td><td align="right"><div class="ioc36_price0">'+s+"<\/td><td>"+(s_size==""?"":"<div>+ <u>"+__ioc38._lbl_size+'<\/u>: <sz class="d'+i+'">'+s_size+"<\/sz><\/div>")+(s_color1==""?"":"<div>+ <u>"+__ioc38._lbl_color1+'<\/u>: <c1 class="d'+r+'">'+s_color1+"<\/c1><\/div>")+(s_color2==""?"":"<div>+ <u>"+__ioc38._lbl_color2+'<\/u>: <c2 class="d'+u+'">'+s_color2+"<\/c2><\/div>")+(s_color3==""?"":"<div>+ <u>"+__ioc38._lbl_color3+'<\/u>: <c3 class="d'+f+'">'+s_color3+"<\/c3><\/div>")+(s_color4==""?"":"<div>+ <u>"+__ioc38._lbl_color4+'<\/u>: <c4 class="d'+e+'">'+s_color4+"<\/c4><\/div>")+'<\/td><td align="right"><div class="ioc36_subtotal0">'+parseInt(n)*parseInt(h)+'<\/div><\/td><td align="center"><a href="javascript:void(0)" onclick="__ioc38.del(this)">Xóa<\/a><\/td><\/tr>');__init_fcurrency2($(".ioc36_subtotal0"));__ioc38.save()},save:function(){var t=$("#"+__ioc38._hdf_value),n="";$("#ioc38_table_tbl").find("tr.item").each(function(){var t=$(this),h=t.attr("i"),c=parseInt(t.attr("p")),i=parseInt(t.attr("q")),r=t.attr("s"),u=t.attr("c1"),f=t.attr("c2"),e=t.attr("c3"),o=t.attr("c4"),l=t.find(".ioc28code").text(),s=t.find(".ioc28name").text(),a=t.find("sz.d"+r).text(),v=t.find("c1.d"+u).text(),y=t.find("c2.d"+f).text(),p=t.find("c3.d"+e).text(),w=t.find("c4.d"+o).text();s!=""&&i>0&&(n+='<i id="'+h+'" code="'+_htmlAttEncode(l)+'" quantity="'+i+'" price="'+c+'" size="'+r+'" sizeS="'+_htmlAttEncode(a)+'" color1="'+u+'" color2="'+f+'" color3="'+e+'" color4="'+o+'" color1S="'+_htmlAttEncode(v)+'" color2S="'+_htmlAttEncode(y)+'" color3S="'+_htmlAttEncode(p)+'" color4S="'+_htmlAttEncode(w)+'">'+_htmlEncode(s)+"<\/i>")});t.val("<r>"+n+"<\/r>");__ioc38.calcTotal();__ioc38.resetCounter()},del:function(n){n=$(n).closest("tr");var t=$(n).attr("i");n.remove();__ioc38.save()},resetCounter:function(){var n=0;$("#ioc38_table_tbl .ioc38i").each(function(){n+=1;$(this).text(_pad(n,2))})},calcTotal:function(){var t=$("#ucDMDataManager5_Edit1_ctl01_OrderSubTotal_1_txt_Value"),r=$("#ucDMDataManager5_Edit1_ctl01_Order_ShipFee_1_txt_Value"),u=$("#ucDMDataManager5_Edit1_ctl01_Order_CouponValue_1_txt_Value"),i=$("#ucDMDataManager5_Edit1_ctl01_Order_Money_1_txt_Value"),n=0;$(".ioc36_subtotal0").each(function(){n+=parseInt($(this).text().replace(/,/g,""))});t.val(n);n=n+parseInt(r.val().replace(/,/g,""))-parseInt(u.val().replace(/,/g,""));i.val(n);__init_fcurrency2(t);__init_fcurrency2(i);__init_fcurrency2($(".ioc36_price0"));__init_fcurrency2($(".ioc36_subtotal0"))},calcShipFee:function(){var r=$("#ucDMDataManager5_Edit1_ctl04_Order_ShipGateway_1_List"),u=$("#ucDMDataManager5_Edit1_ctl04_Order_ShipQuanHuyen_1_List"),f=$("#ucDMDataManager5_Edit1_ctl01_OrderSubTotal_1_txt_Value"),e=$("#ucDMDataManager5_Edit1_ctl01_Order_ShipFee_1_txt_Value"),o=$("#ucDMDataManager5_Edit1_ctl01_Order_Money_1_txt_Value"),n=u.val(),t=r.val(),i;n>0&&t>0&&(i=f.val(),$.post(__gvars.ajurl,{action:"ec_optlist_ship",q:n,t:t,total:i},function(n){var t=n.split("<@>");n=t[0];n==""&&(n="0");e.val(t[1]);__ioc38.calcTotal()}))}};