function _booking1002_checkoverlap(n,t,i){for(var r=0;r<n.length;r++)if(t>n[r].start&&t<n[r].end||i>n[r].start&&i<n[r].end||t>=n[r].start&&i<=n[r].end||t<=n[r].start&&i>=n[r].end)return!0;return!1}function _init_booking1002_cal(n,t,i,r,u,f,e,o){$("#d_booking1002_form > .btn-title").click(function(){$(this).next("main").slideToggle()});$("#d_booking1002_back").click(function(){$("#d_booking1002_form > .btn-title").click()});$("#"+n).html("");var s=new Date,l=s.getDate(),a=s.getMonth(),v=s.getFullYear(),c=e==1?"vi":"en",h=$("#"+n).fullCalendar({lang:c,header:{left:"title",center:"",right:"prev,next today month,agendaWeek"},views:{agenda3Day:{type:"agenda",duration:{days:3},buttonText:"3 day"}},height:520,minTime:u,maxTime:f,allDaySlot:!1,selectable:!1,selectHelper:!0,editable:!0,disableResizing:!0,allDayDefault:!1,defaultView:"month",eventTextColor:"#000",firstDay:1,slotDuration:"00:15:00",slotLabelFormat:"hh:mm A",slotLabelInterval:15,eventRender:function(n,t){t.qtip({show:{solo:!0,target:!1,effect:!0,delay:50},position:{my:"bottom center",at:"top center",viewport:$(window)},content:{title:'<div style="font-weight:bold">'+n.title+"<\/div>",text:"<div>"+n.description+"<\/div>"},style:{classes:"qtip qtip-default  qtip-light qtip-rounded qtip-shadow"}})},events:function(n,t,i,r){_po_cal_current_startdate=n;$.post(__gvars.ajurl,{action:"getcal_event",s:n.year()+"-"+n.month()+"-"+n.date()+"-"+n.hours()+"-"+n.minutes(),e:t.year()+"-"+t.month()+"-"+t.date()+"-"+t.hours()+"-"+t.minutes()},function(n){if(n!=""){var t=[];$("<r>"+n+"<\/r>").find("i").each(function(){var n=$(this),u=n.attr("start"),r=u.split(","),i;u=n.attr("end");i=u.split(",");t.push({title:decodeURIComponent(n.attr("title")),start:new Date(r[0],r[1],r[2],r[3],r[4],0),end:new Date(i[0],i[1],i[2],i[3],i[4],0),backgroundColor:"transparent",borderColor:"transparent",color:n.attr("color"),description:decodeURIComponent(n.attr("description")),className:n.attr("status")=="1"?"e_completed":"",editable:!1,durationEditable:!1})});r(t)}})}});o&&$("#contact_duration").change(function(){var n=$(this).val(),u=h.fullCalendar("clientEvents"),t=_booking1002.start,i=_booking1002.end,f,r;if(i=new Date(t.getTime()+n*6e4),f=_booking1002_checkoverlap(u,t,i),r=!0,f){while(r)n>15&&(n=n-15,i=new Date(t.getTime()+n*6e4),r=_booking1002_checkoverlap(u,t,i));$(this).val(n)}});$(window).width()<801&&(h.fullCalendar("changeView","agenda3Day"),h.fullCalendar("option","height","auto"))}var _booking1002={start:new Date,end:new Date};